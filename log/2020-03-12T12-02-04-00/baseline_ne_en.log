================ FLORES BASELINE REPRODUCTION SCRIPT WITH FP16 TRAINING + LARGEBATCH + CLIP_NORM 0.1 ================
About to train the supervised for the following language pair: NE-EN
Checkpoint directory unset! Setting to default value...
CHECKPOINT_DIR is set to './checkpoints/2020-03-12T12-02-04-00/checkpoints_ne_en'
Creating checkpoint directory if it doesn't exist...
Data folder is: data-bin/wiki_ne_en_bpe5000/
Beginning training...
Time at beginning: Thu Mar 12 12:02:44 EDT 2020
Namespace(activation_dropout=0.2, activation_fn='relu', adam_betas='(0.9, 0.98)', adam_eps=1e-08, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, arch='transformer', attention_dropout=0.2, best_checkpoint_metric='loss', bpe=None, bucket_cap_mb=25, clip_norm=0.1, cpu=False, criterion='label_smoothed_cross_entropy', cross_self_attention=False, curriculum=0, data='data-bin/wiki_ne_en_bpe5000/', dataset_impl=None, ddp_backend='c10d', decoder_attention_heads=2, decoder_embed_dim=512, decoder_embed_path=None, decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0, decoder_layers=5, decoder_layers_to_keep=None, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_port=-1, distributed_rank=0, distributed_world_size=1, dropout=0.4, empty_cache_freq=0, encoder_attention_heads=2, encoder_embed_dim=512, encoder_embed_path=None, encoder_ffn_embed_dim=2048, encoder_layerdrop=0, encoder_layers=5, encoder_layers_to_keep=None, encoder_learned_pos=False, encoder_normalize_before=True, fast_stat_sync=False, find_unused_parameters=False, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_init_scale=128, fp16_scale_tolerance=0.0, fp16_scale_window=None, keep_interval_updates=-1, keep_last_epochs=-1, label_smoothing=0.2, layer_wise_attention=False, layernorm_embedding=False, lazy_load=False, left_pad_source='True', left_pad_target='False', load_alignments=False, log_format=None, log_interval=1000, lr=[0.001], lr_scheduler='inverse_sqrt', max_epoch=100, max_sentences=None, max_sentences_valid=None, max_source_positions=1024, max_target_positions=1024, max_tokens=16000, max_tokens_valid=16000, max_update=0, maximize_best_checkpoint_metric=False, memory_efficient_fp16=False, min_loss_scale=0.0001, min_lr=1e-09, no_cross_attention=False, no_epoch_checkpoints=False, no_last_checkpoints=False, no_progress_bar=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_token_positional_embeddings=False, num_workers=1, optimizer='adam', optimizer_overrides='{}', raw_text=False, required_batch_size_multiple=8, reset_dataloader=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/2020-03-12T12-02-04-00/checkpoints_ne_en', save_interval=10, save_interval_updates=0, seed=1, sentence_avg=False, share_all_embeddings=True, share_decoder_input_output_embed=False, skip_invalid_size_inputs_valid_test=False, source_lang='ne', target_lang='en', task='translation', tensorboard_logdir='', threshold_loss_scale=None, tokenizer=None, train_subset='train', truncate_source=False, update_freq=[1], upsample_primary=1, use_bmuf=False, user_dir=None, valid_subset='valid', validate_interval=1, warmup_init_lr=1e-07, warmup_updates=4000, weight_decay=0.0001)
| [ne] dictionary: 5000 types
| [en] dictionary: 5000 types
| loaded 2559 examples from: data-bin/wiki_ne_en_bpe5000/valid.ne-en.ne
| loaded 2559 examples from: data-bin/wiki_ne_en_bpe5000/valid.ne-en.en
| data-bin/wiki_ne_en_bpe5000/ valid ne-en 2559 examples
TransformerModel(
  (encoder): TransformerEncoder(
    (embed_tokens): Embedding(5000, 512, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (decoder): TransformerDecoder(
    (embed_tokens): Embedding(5000, 512, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (4): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
)
| model transformer, criterion LabelSmoothedCrossEntropyCriterion
| num. model params: 39344128 (num. trained: 39344128)
| training on 1 GPUs
| max tokens per GPU = 16000 and max sentences per GPU = None
| no existing checkpoint found ./checkpoints/2020-03-12T12-02-04-00/checkpoints_ne_en/checkpoint_last.pt
| loading train data for epoch 0
| loaded 563779 examples from: data-bin/wiki_ne_en_bpe5000/train.ne-en.ne
| loaded 563779 examples from: data-bin/wiki_ne_en_bpe5000/train.ne-en.en
| data-bin/wiki_ne_en_bpe5000/ train ne-en 563779 examples
| WARNING: overflow detected, setting loss scale to: 64.0
| WARNING: overflow detected, setting loss scale to: 32.0
| WARNING: overflow detected, setting loss scale to: 16.0
| WARNING: overflow detected, setting loss scale to: 8.0
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 001 | loss 10.297 | nll_loss 9.471 | ppl 709.53 | wps 81413 | ups 7 | wpb 11846.851 | bsz 892.451 | num_updates 619 | lr 0.000154835 | gnorm 1.304 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 95 | train_wall 88
| epoch 001 | valid on 'valid' subset | loss 9.583 | nll_loss 8.427 | ppl 344.16 | num_updates 619
| epoch 002 | loss 8.642 | nll_loss 7.248 | ppl 151.97 | wps 80773 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 1243 | lr 0.000310819 | gnorm 1.023 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 187 | train_wall 177
| epoch 002 | valid on 'valid' subset | loss 8.917 | nll_loss 7.420 | ppl 171.31 | num_updates 1243
| epoch 003 | loss 7.680 | nll_loss 5.974 | ppl 62.84 | wps 80347 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 1867 | lr 0.000466803 | gnorm 0.804 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 280 | train_wall 267
| epoch 003 | valid on 'valid' subset | loss 8.500 | nll_loss 6.837 | ppl 114.35 | num_updates 1867
| epoch 004 | loss 7.064 | nll_loss 5.155 | ppl 35.63 | wps 80193 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 2491 | lr 0.000622788 | gnorm 0.728 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 373 | train_wall 357
| epoch 004 | valid on 'valid' subset | loss 8.305 | nll_loss 6.602 | ppl 97.15 | num_updates 2491
| epoch 005 | loss 6.634 | nll_loss 4.586 | ppl 24.02 | wps 79907 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 3115 | lr 0.000778772 | gnorm 0.645 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 466 | train_wall 448
| epoch 005 | valid on 'valid' subset | loss 8.027 | nll_loss 6.191 | ppl 73.05 | num_updates 3115
| epoch 006 | loss 6.351 | nll_loss 4.215 | ppl 18.57 | wps 79700 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 3739 | lr 0.000934757 | gnorm 0.576 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 560 | train_wall 538
| epoch 006 | valid on 'valid' subset | loss 7.923 | nll_loss 6.029 | ppl 65.31 | num_updates 3739
| epoch 007 | loss 6.126 | nll_loss 3.923 | ppl 15.16 | wps 79891 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 4363 | lr 0.000957497 | gnorm 0.512 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 653 | train_wall 629
| epoch 007 | valid on 'valid' subset | loss 7.765 | nll_loss 5.821 | ppl 56.54 | num_updates 4363
| epoch 008 | loss 5.923 | nll_loss 3.663 | ppl 12.67 | wps 79561 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 4987 | lr 0.000895592 | gnorm 0.462 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 747 | train_wall 720
| epoch 008 | valid on 'valid' subset | loss 7.594 | nll_loss 5.603 | ppl 48.6 | num_updates 4987
| epoch 009 | loss 5.757 | nll_loss 3.451 | ppl 10.94 | wps 79808 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 5611 | lr 0.000844325 | gnorm 0.416 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 840 | train_wall 810
| epoch 009 | valid on 'valid' subset | loss 7.470 | nll_loss 5.448 | ppl 43.64 | num_updates 5611
| epoch 010 | loss 5.646 | nll_loss 3.310 | ppl 9.92 | wps 79970 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 6235 | lr 0.000800962 | gnorm 0.400 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 933 | train_wall 901
| epoch 010 | valid on 'valid' subset | loss 7.385 | nll_loss 5.346 | ppl 40.68 | num_updates 6235
| saved checkpoint ./checkpoints/2020-03-12T12-02-04-00/checkpoints_ne_en/checkpoint10.pt (epoch 10 @ 6235 updates) (writing took 0.6793763637542725 seconds)
| epoch 011 | loss 5.543 | nll_loss 3.177 | ppl 9.05 | wps 79677 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 6859 | lr 0.000763659 | gnorm 0.372 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 1027 | train_wall 991
| epoch 011 | valid on 'valid' subset | loss 7.306 | nll_loss 5.208 | ppl 36.95 | num_updates 6859 | best_loss 7.30615
| epoch 012 | loss 5.463 | nll_loss 3.076 | ppl 8.43 | wps 79877 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 7483 | lr 0.000731126 | gnorm 0.361 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 1121 | train_wall 1082
| epoch 012 | valid on 'valid' subset | loss 7.261 | nll_loss 5.137 | ppl 35.19 | num_updates 7483 | best_loss 7.26139
| epoch 013 | loss 5.400 | nll_loss 2.996 | ppl 7.98 | wps 79776 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 8107 | lr 0.000702425 | gnorm 0.350 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 1214 | train_wall 1172
| epoch 013 | valid on 'valid' subset | loss 7.211 | nll_loss 5.088 | ppl 34.02 | num_updates 8107 | best_loss 7.21144
| epoch 014 | loss 5.344 | nll_loss 2.925 | ppl 7.59 | wps 79943 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 8731 | lr 0.000676859 | gnorm 0.340 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 1307 | train_wall 1262
| epoch 014 | valid on 'valid' subset | loss 7.190 | nll_loss 5.027 | ppl 32.6 | num_updates 8731 | best_loss 7.18987
| epoch 015 | loss 5.302 | nll_loss 2.872 | ppl 7.32 | wps 79742 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 9355 | lr 0.000653895 | gnorm 0.341 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 1401 | train_wall 1353
| epoch 015 | valid on 'valid' subset | loss 7.182 | nll_loss 5.039 | ppl 32.88 | num_updates 9355 | best_loss 7.18162
| epoch 016 | loss 5.258 | nll_loss 2.816 | ppl 7.04 | wps 79723 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 9979 | lr 0.000633121 | gnorm 0.328 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 1494 | train_wall 1444
| epoch 016 | valid on 'valid' subset | loss 7.105 | nll_loss 4.927 | ppl 30.42 | num_updates 9979 | best_loss 7.10549
| epoch 017 | loss 5.220 | nll_loss 2.767 | ppl 6.81 | wps 79786 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 10603 | lr 0.000614208 | gnorm 0.327 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 1588 | train_wall 1534
| epoch 017 | valid on 'valid' subset | loss 7.105 | nll_loss 4.934 | ppl 30.56 | num_updates 10603 | best_loss 7.10488
| epoch 018 | loss 5.190 | nll_loss 2.730 | ppl 6.63 | wps 79789 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 11227 | lr 0.000596895 | gnorm 0.324 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 1681 | train_wall 1625
| epoch 018 | valid on 'valid' subset | loss 7.120 | nll_loss 4.937 | ppl 30.64 | num_updates 11227 | best_loss 7.11989
| epoch 019 | loss 5.159 | nll_loss 2.691 | ppl 6.46 | wps 79691 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 11851 | lr 0.000580968 | gnorm 0.317 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 1775 | train_wall 1715
| epoch 019 | valid on 'valid' subset | loss 7.068 | nll_loss 4.877 | ppl 29.38 | num_updates 11851 | best_loss 7.06816
| epoch 020 | loss 5.132 | nll_loss 2.656 | ppl 6.3 | wps 79762 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 12475 | lr 0.000566252 | gnorm 0.315 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 1868 | train_wall 1806
| epoch 020 | valid on 'valid' subset | loss 7.026 | nll_loss 4.830 | ppl 28.45 | num_updates 12475 | best_loss 7.02619
| saved checkpoint ./checkpoints/2020-03-12T12-02-04-00/checkpoints_ne_en/checkpoint20.pt (epoch 20 @ 12475 updates) (writing took 1.0487329959869385 seconds)
| epoch 021 | loss 5.109 | nll_loss 2.628 | ppl 6.18 | wps 79520 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 13099 | lr 0.0005526 | gnorm 0.318 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 1963 | train_wall 1896
| epoch 021 | valid on 'valid' subset | loss 7.019 | nll_loss 4.825 | ppl 28.35 | num_updates 13099 | best_loss 7.01945
| epoch 022 | loss 5.089 | nll_loss 2.602 | ppl 6.07 | wps 79803 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 13723 | lr 0.00053989 | gnorm 0.316 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 2056 | train_wall 1987
| epoch 022 | valid on 'valid' subset | loss 7.052 | nll_loss 4.851 | ppl 28.86 | num_updates 13723 | best_loss 7.02619
| epoch 023 | loss 5.065 | nll_loss 2.571 | ppl 5.94 | wps 79780 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 14347 | lr 0.000528019 | gnorm 0.310 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 2150 | train_wall 2077
| epoch 023 | valid on 'valid' subset | loss 7.022 | nll_loss 4.803 | ppl 27.91 | num_updates 14347 | best_loss 7.02157
| epoch 024 | loss 5.046 | nll_loss 2.548 | ppl 5.85 | wps 79872 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 14971 | lr 0.000516898 | gnorm 0.310 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 2243 | train_wall 2168
| epoch 024 | valid on 'valid' subset | loss 6.999 | nll_loss 4.790 | ppl 27.67 | num_updates 14971 | best_loss 6.99908
| epoch 025 | loss 5.028 | nll_loss 2.525 | ppl 5.76 | wps 79842 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 15595 | lr 0.000506451 | gnorm 0.309 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 2336 | train_wall 2258
| epoch 025 | valid on 'valid' subset | loss 6.980 | nll_loss 4.769 | ppl 27.26 | num_updates 15595 | best_loss 6.9803
| epoch 026 | loss 5.010 | nll_loss 2.502 | ppl 5.66 | wps 79861 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 16219 | lr 0.000496613 | gnorm 0.305 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 2430 | train_wall 2349
| epoch 026 | valid on 'valid' subset | loss 6.960 | nll_loss 4.745 | ppl 26.82 | num_updates 16219 | best_loss 6.95961
| epoch 027 | loss 4.997 | nll_loss 2.486 | ppl 5.6 | wps 79844 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 16843 | lr 0.000487327 | gnorm 0.305 | clip 1.000 | oom 0.000 | loss_scale 8.000 | wall 2523 | train_wall 2439
| epoch 027 | valid on 'valid' subset | loss 6.992 | nll_loss 4.779 | ppl 27.45 | num_updates 16843 | best_loss 6.99206
| epoch 028 | loss 4.979 | nll_loss 2.464 | ppl 5.52 | wps 79779 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 17467 | lr 0.000478543 | gnorm 0.302 | clip 1.000 | oom 0.000 | loss_scale 8.000 | wall 2616 | train_wall 2530
| epoch 028 | valid on 'valid' subset | loss 6.928 | nll_loss 4.706 | ppl 26.1 | num_updates 17467 | best_loss 6.92848
| epoch 029 | loss 4.966 | nll_loss 2.448 | ppl 5.45 | wps 79788 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 18091 | lr 0.000470217 | gnorm 0.302 | clip 1.000 | oom 0.000 | loss_scale 8.000 | wall 2710 | train_wall 2620
| epoch 029 | valid on 'valid' subset | loss 6.941 | nll_loss 4.709 | ppl 26.16 | num_updates 18091 | best_loss 6.94103
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 030 | loss 4.954 | nll_loss 2.433 | ppl 5.4 | wps 79699 | ups 7 | wpb 11864.164 | bsz 896.390 | num_updates 18714 | lr 0.000462324 | gnorm 0.305 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 2803 | train_wall 2710
| epoch 030 | valid on 'valid' subset | loss 6.896 | nll_loss 4.669 | ppl 25.44 | num_updates 18714 | best_loss 6.89583
| saved checkpoint ./checkpoints/2020-03-12T12-02-04-00/checkpoints_ne_en/checkpoint30.pt (epoch 30 @ 18714 updates) (writing took 1.0214078426361084 seconds)
| epoch 031 | loss 4.942 | nll_loss 2.418 | ppl 5.34 | wps 79544 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 19338 | lr 0.000454804 | gnorm 0.303 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 2898 | train_wall 2801
| epoch 031 | valid on 'valid' subset | loss 6.875 | nll_loss 4.642 | ppl 24.97 | num_updates 19338 | best_loss 6.87456
| epoch 032 | loss 4.929 | nll_loss 2.401 | ppl 5.28 | wps 79942 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 19962 | lr 0.000447639 | gnorm 0.301 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 2991 | train_wall 2891
| epoch 032 | valid on 'valid' subset | loss 6.911 | nll_loss 4.672 | ppl 25.49 | num_updates 19962 | best_loss 6.89583
| epoch 033 | loss 4.919 | nll_loss 2.388 | ppl 5.23 | wps 79667 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 20586 | lr 0.000440802 | gnorm 0.303 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 3085 | train_wall 2982
| epoch 033 | valid on 'valid' subset | loss 6.903 | nll_loss 4.677 | ppl 25.58 | num_updates 20586 | best_loss 6.89583
| epoch 034 | loss 4.910 | nll_loss 2.376 | ppl 5.19 | wps 79805 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 21210 | lr 0.00043427 | gnorm 0.306 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 3178 | train_wall 3072
| epoch 034 | valid on 'valid' subset | loss 6.895 | nll_loss 4.658 | ppl 25.25 | num_updates 21210 | best_loss 6.89509
| epoch 035 | loss 4.899 | nll_loss 2.363 | ppl 5.14 | wps 79716 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 21834 | lr 0.000428019 | gnorm 0.302 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 3271 | train_wall 3163
| epoch 035 | valid on 'valid' subset | loss 6.894 | nll_loss 4.642 | ppl 24.97 | num_updates 21834 | best_loss 6.8938
| epoch 036 | loss 4.890 | nll_loss 2.352 | ppl 5.11 | wps 79585 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 22458 | lr 0.000422031 | gnorm 0.310 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 3365 | train_wall 3253
| epoch 036 | valid on 'valid' subset | loss 6.899 | nll_loss 4.668 | ppl 25.42 | num_updates 22458 | best_loss 6.89583
| epoch 037 | loss 4.879 | nll_loss 2.338 | ppl 5.05 | wps 79597 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 23082 | lr 0.000416287 | gnorm 0.303 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 3459 | train_wall 3343
| epoch 037 | valid on 'valid' subset | loss 6.872 | nll_loss 4.633 | ppl 24.81 | num_updates 23082 | best_loss 6.87206
| epoch 038 | loss 4.871 | nll_loss 2.327 | ppl 5.02 | wps 79965 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 23706 | lr 0.000410772 | gnorm 0.306 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 3552 | train_wall 3434
| epoch 038 | valid on 'valid' subset | loss 6.885 | nll_loss 4.651 | ppl 25.12 | num_updates 23706 | best_loss 6.88527
| epoch 039 | loss 4.861 | nll_loss 2.315 | ppl 4.98 | wps 79389 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 24330 | lr 0.00040547 | gnorm 0.299 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 3646 | train_wall 3525
| epoch 039 | valid on 'valid' subset | loss 6.860 | nll_loss 4.623 | ppl 24.65 | num_updates 24330 | best_loss 6.86031
| epoch 040 | loss 4.853 | nll_loss 2.305 | ppl 4.94 | wps 79939 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 24954 | lr 0.000400369 | gnorm 0.301 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 3739 | train_wall 3615
| epoch 040 | valid on 'valid' subset | loss 6.852 | nll_loss 4.611 | ppl 24.44 | num_updates 24954 | best_loss 6.8519
| saved checkpoint ./checkpoints/2020-03-12T12-02-04-00/checkpoints_ne_en/checkpoint40.pt (epoch 40 @ 24954 updates) (writing took 0.9976544380187988 seconds)
| epoch 041 | loss 4.844 | nll_loss 2.294 | ppl 4.9 | wps 79650 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 25578 | lr 0.000395455 | gnorm 0.301 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 3833 | train_wall 3705
| epoch 041 | valid on 'valid' subset | loss 6.847 | nll_loss 4.610 | ppl 24.42 | num_updates 25578 | best_loss 6.84678
| epoch 042 | loss 4.839 | nll_loss 2.288 | ppl 4.88 | wps 79795 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 26202 | lr 0.000390717 | gnorm 0.301 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 3927 | train_wall 3796
| epoch 042 | valid on 'valid' subset | loss 6.849 | nll_loss 4.607 | ppl 24.37 | num_updates 26202 | best_loss 6.84853
| epoch 043 | loss 4.830 | nll_loss 2.276 | ppl 4.84 | wps 79783 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 26826 | lr 0.000386146 | gnorm 0.305 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 4020 | train_wall 3886
| epoch 043 | valid on 'valid' subset | loss 6.851 | nll_loss 4.620 | ppl 24.59 | num_updates 26826 | best_loss 6.85059
| epoch 044 | loss 4.825 | nll_loss 2.270 | ppl 4.82 | wps 79764 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 27450 | lr 0.000381732 | gnorm 0.300 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 4114 | train_wall 3977
| epoch 044 | valid on 'valid' subset | loss 6.853 | nll_loss 4.605 | ppl 24.34 | num_updates 27450 | best_loss 6.8519
| epoch 045 | loss 4.818 | nll_loss 2.262 | ppl 4.8 | wps 79721 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 28074 | lr 0.000377466 | gnorm 0.301 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 4207 | train_wall 4067
| epoch 045 | valid on 'valid' subset | loss 6.848 | nll_loss 4.609 | ppl 24.4 | num_updates 28074 | best_loss 6.84804
| epoch 046 | loss 4.810 | nll_loss 2.251 | ppl 4.76 | wps 79878 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 28698 | lr 0.00037334 | gnorm 0.297 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 4300 | train_wall 4158
| epoch 046 | valid on 'valid' subset | loss 6.847 | nll_loss 4.601 | ppl 24.27 | num_updates 28698 | best_loss 6.84701
| epoch 047 | loss 4.806 | nll_loss 2.247 | ppl 4.75 | wps 80087 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 29322 | lr 0.000369346 | gnorm 0.305 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 4394 | train_wall 4248
| epoch 047 | valid on 'valid' subset | loss 6.839 | nll_loss 4.591 | ppl 24.11 | num_updates 29322 | best_loss 6.83944
| epoch 048 | loss 4.798 | nll_loss 2.236 | ppl 4.71 | wps 79705 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 29946 | lr 0.000365477 | gnorm 0.308 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 4487 | train_wall 4338
| epoch 048 | valid on 'valid' subset | loss 6.838 | nll_loss 4.592 | ppl 24.11 | num_updates 29946 | best_loss 6.83774
| epoch 049 | loss 4.792 | nll_loss 2.229 | ppl 4.69 | wps 79687 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 30570 | lr 0.000361728 | gnorm 0.301 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 4581 | train_wall 4429
| epoch 049 | valid on 'valid' subset | loss 6.845 | nll_loss 4.605 | ppl 24.34 | num_updates 30570 | best_loss 6.84461
| epoch 050 | loss 4.786 | nll_loss 2.222 | ppl 4.66 | wps 79852 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 31194 | lr 0.000358092 | gnorm 0.309 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 4674 | train_wall 4519
| epoch 050 | valid on 'valid' subset | loss 6.840 | nll_loss 4.586 | ppl 24.01 | num_updates 31194 | best_loss 6.84034
| saved checkpoint ./checkpoints/2020-03-12T12-02-04-00/checkpoints_ne_en/checkpoint50.pt (epoch 50 @ 31194 updates) (writing took 0.9908521175384521 seconds)
| epoch 051 | loss 4.779 | nll_loss 2.213 | ppl 4.64 | wps 79767 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 31818 | lr 0.000354563 | gnorm 0.298 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 4768 | train_wall 4610
| epoch 051 | valid on 'valid' subset | loss 6.834 | nll_loss 4.592 | ppl 24.11 | num_updates 31818 | best_loss 6.83375
| epoch 052 | loss 4.777 | nll_loss 2.210 | ppl 4.63 | wps 79784 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 32442 | lr 0.000351137 | gnorm 0.302 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 4862 | train_wall 4700
| epoch 052 | valid on 'valid' subset | loss 6.829 | nll_loss 4.578 | ppl 23.88 | num_updates 32442 | best_loss 6.82863
| epoch 053 | loss 4.771 | nll_loss 2.203 | ppl 4.6 | wps 79786 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 33066 | lr 0.000347808 | gnorm 0.303 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 4955 | train_wall 4790
| epoch 053 | valid on 'valid' subset | loss 6.808 | nll_loss 4.574 | ppl 23.82 | num_updates 33066 | best_loss 6.808
| epoch 054 | loss 4.765 | nll_loss 2.196 | ppl 4.58 | wps 79713 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 33690 | lr 0.000344572 | gnorm 0.297 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 5049 | train_wall 4881
| epoch 054 | valid on 'valid' subset | loss 6.823 | nll_loss 4.573 | ppl 23.81 | num_updates 33690 | best_loss 6.82337
| epoch 055 | loss 4.761 | nll_loss 2.191 | ppl 4.57 | wps 79748 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 34314 | lr 0.000341424 | gnorm 0.301 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 5142 | train_wall 4971
| epoch 055 | valid on 'valid' subset | loss 6.839 | nll_loss 4.609 | ppl 24.4 | num_updates 34314 | best_loss 6.8389
| epoch 056 | loss 4.755 | nll_loss 2.182 | ppl 4.54 | wps 79690 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 34938 | lr 0.000338362 | gnorm 0.306 | clip 1.000 | oom 0.000 | loss_scale 8.000 | wall 5236 | train_wall 5062
| epoch 056 | valid on 'valid' subset | loss 6.819 | nll_loss 4.582 | ppl 23.95 | num_updates 34938 | best_loss 6.8187
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 057 | loss 4.752 | nll_loss 2.179 | ppl 4.53 | wps 79801 | ups 7 | wpb 11862.347 | bsz 892.936 | num_updates 35561 | lr 0.000335385 | gnorm 0.298 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 5329 | train_wall 5152
| epoch 057 | valid on 'valid' subset | loss 6.842 | nll_loss 4.586 | ppl 24.02 | num_updates 35561 | best_loss 6.84034
| epoch 058 | loss 4.747 | nll_loss 2.173 | ppl 4.51 | wps 79946 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 36185 | lr 0.00033248 | gnorm 0.300 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 5422 | train_wall 5242
| epoch 058 | valid on 'valid' subset | loss 6.786 | nll_loss 4.539 | ppl 23.25 | num_updates 36185 | best_loss 6.78598
| epoch 059 | loss 4.742 | nll_loss 2.166 | ppl 4.49 | wps 79910 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 36809 | lr 0.00032965 | gnorm 0.301 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 5515 | train_wall 5333
| epoch 059 | valid on 'valid' subset | loss 6.823 | nll_loss 4.590 | ppl 24.08 | num_updates 36809 | best_loss 6.82288
| epoch 060 | loss 4.738 | nll_loss 2.161 | ppl 4.47 | wps 79852 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 37433 | lr 0.000326891 | gnorm 0.300 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 5608 | train_wall 5423
| epoch 060 | valid on 'valid' subset | loss 6.804 | nll_loss 4.556 | ppl 23.52 | num_updates 37433 | best_loss 6.8036
| saved checkpoint ./checkpoints/2020-03-12T12-02-04-00/checkpoints_ne_en/checkpoint60.pt (epoch 60 @ 37433 updates) (writing took 1.0139949321746826 seconds)
| epoch 061 | loss 4.733 | nll_loss 2.156 | ppl 4.46 | wps 79779 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 38057 | lr 0.0003242 | gnorm 0.300 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 5703 | train_wall 5514
| epoch 061 | valid on 'valid' subset | loss 6.779 | nll_loss 4.530 | ppl 23.11 | num_updates 38057 | best_loss 6.77851
| epoch 062 | loss 4.729 | nll_loss 2.150 | ppl 4.44 | wps 79772 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 38681 | lr 0.000321574 | gnorm 0.301 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 5796 | train_wall 5604
| epoch 062 | valid on 'valid' subset | loss 6.807 | nll_loss 4.562 | ppl 23.63 | num_updates 38681 | best_loss 6.8036
| epoch 063 | loss 4.726 | nll_loss 2.147 | ppl 4.43 | wps 79906 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 39305 | lr 0.000319011 | gnorm 0.305 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 5889 | train_wall 5695
| epoch 063 | valid on 'valid' subset | loss 6.820 | nll_loss 4.573 | ppl 23.8 | num_updates 39305 | best_loss 6.8036
| epoch 064 | loss 4.721 | nll_loss 2.140 | ppl 4.41 | wps 79723 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 39929 | lr 0.000316509 | gnorm 0.303 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 5983 | train_wall 5785
| epoch 064 | valid on 'valid' subset | loss 6.783 | nll_loss 4.535 | ppl 23.19 | num_updates 39929 | best_loss 6.78287
| epoch 065 | loss 4.718 | nll_loss 2.137 | ppl 4.4 | wps 79709 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 40553 | lr 0.000314064 | gnorm 0.305 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 6076 | train_wall 5875
| epoch 065 | valid on 'valid' subset | loss 6.807 | nll_loss 4.568 | ppl 23.72 | num_updates 40553 | best_loss 6.8036
| epoch 066 | loss 4.715 | nll_loss 2.134 | ppl 4.39 | wps 79553 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 41177 | lr 0.000311675 | gnorm 0.310 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 6170 | train_wall 5966
| epoch 066 | valid on 'valid' subset | loss 6.827 | nll_loss 4.595 | ppl 24.17 | num_updates 41177 | best_loss 6.8036
| epoch 067 | loss 4.710 | nll_loss 2.127 | ppl 4.37 | wps 80019 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 41801 | lr 0.00030934 | gnorm 0.302 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 6263 | train_wall 6056
| epoch 067 | valid on 'valid' subset | loss 6.786 | nll_loss 4.540 | ppl 23.26 | num_updates 41801 | best_loss 6.78555
| epoch 068 | loss 4.706 | nll_loss 2.121 | ppl 4.35 | wps 79751 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 42425 | lr 0.000307057 | gnorm 0.300 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 6357 | train_wall 6147
| epoch 068 | valid on 'valid' subset | loss 6.797 | nll_loss 4.555 | ppl 23.5 | num_updates 42425 | best_loss 6.79679
| epoch 069 | loss 4.702 | nll_loss 2.116 | ppl 4.34 | wps 79897 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 43049 | lr 0.000304824 | gnorm 0.301 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 6450 | train_wall 6238
| epoch 069 | valid on 'valid' subset | loss 6.824 | nll_loss 4.577 | ppl 23.86 | num_updates 43049 | best_loss 6.8036
| epoch 070 | loss 4.700 | nll_loss 2.114 | ppl 4.33 | wps 79449 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 43673 | lr 0.000302638 | gnorm 0.308 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 6544 | train_wall 6328
| epoch 070 | valid on 'valid' subset | loss 6.797 | nll_loss 4.542 | ppl 23.3 | num_updates 43673 | best_loss 6.79681
| saved checkpoint ./checkpoints/2020-03-12T12-02-04-00/checkpoints_ne_en/checkpoint70.pt (epoch 70 @ 43673 updates) (writing took 1.017310380935669 seconds)
| epoch 071 | loss 4.696 | nll_loss 2.109 | ppl 4.31 | wps 79866 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 44297 | lr 0.000300499 | gnorm 0.302 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 6638 | train_wall 6419
| epoch 071 | valid on 'valid' subset | loss 6.802 | nll_loss 4.560 | ppl 23.58 | num_updates 44297 | best_loss 6.79681
| epoch 072 | loss 4.692 | nll_loss 2.105 | ppl 4.3 | wps 79639 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 44921 | lr 0.000298404 | gnorm 0.301 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 6732 | train_wall 6509
| epoch 072 | valid on 'valid' subset | loss 6.767 | nll_loss 4.517 | ppl 22.89 | num_updates 44921 | best_loss 6.76708
| epoch 073 | loss 4.689 | nll_loss 2.100 | ppl 4.29 | wps 79731 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 45545 | lr 0.000296353 | gnorm 0.303 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 6825 | train_wall 6600
| epoch 073 | valid on 'valid' subset | loss 6.765 | nll_loss 4.514 | ppl 22.85 | num_updates 45545 | best_loss 6.76462
| epoch 074 | loss 4.687 | nll_loss 2.098 | ppl 4.28 | wps 80077 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 46169 | lr 0.000294344 | gnorm 0.313 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 6918 | train_wall 6690
| epoch 074 | valid on 'valid' subset | loss 6.796 | nll_loss 4.552 | ppl 23.45 | num_updates 46169 | best_loss 6.79568
| epoch 075 | loss 4.683 | nll_loss 2.094 | ppl 4.27 | wps 80033 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 46793 | lr 0.000292375 | gnorm 0.306 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 7011 | train_wall 6780
| epoch 075 | valid on 'valid' subset | loss 6.790 | nll_loss 4.546 | ppl 23.36 | num_updates 46793 | best_loss 6.79013
| epoch 076 | loss 4.681 | nll_loss 2.090 | ppl 4.26 | wps 79844 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 47417 | lr 0.000290444 | gnorm 0.311 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 7104 | train_wall 6871
| epoch 076 | valid on 'valid' subset | loss 6.777 | nll_loss 4.532 | ppl 23.13 | num_updates 47417 | best_loss 6.77734
| epoch 077 | loss 4.677 | nll_loss 2.085 | ppl 4.24 | wps 79843 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 48041 | lr 0.000288552 | gnorm 0.321 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 7198 | train_wall 6961
| epoch 077 | valid on 'valid' subset | loss 6.796 | nll_loss 4.542 | ppl 23.3 | num_updates 48041 | best_loss 6.7964
| epoch 078 | loss 4.675 | nll_loss 2.083 | ppl 4.24 | wps 80027 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 48665 | lr 0.000286696 | gnorm 0.305 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 7291 | train_wall 7051
| epoch 078 | valid on 'valid' subset | loss 6.792 | nll_loss 4.542 | ppl 23.3 | num_updates 48665 | best_loss 6.79167
| epoch 079 | loss 4.671 | nll_loss 2.077 | ppl 4.22 | wps 79792 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 49289 | lr 0.000284875 | gnorm 0.304 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 7384 | train_wall 7142
| epoch 079 | valid on 'valid' subset | loss 6.787 | nll_loss 4.543 | ppl 23.32 | num_updates 49289 | best_loss 6.78704
| epoch 080 | loss 4.668 | nll_loss 2.074 | ppl 4.21 | wps 80042 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 49913 | lr 0.000283089 | gnorm 0.305 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 7477 | train_wall 7232
| epoch 080 | valid on 'valid' subset | loss 6.777 | nll_loss 4.524 | ppl 23 | num_updates 49913 | best_loss 6.77651
| saved checkpoint ./checkpoints/2020-03-12T12-02-04-00/checkpoints_ne_en/checkpoint80.pt (epoch 80 @ 49913 updates) (writing took 0.9956650733947754 seconds)
| epoch 081 | loss 4.666 | nll_loss 2.072 | ppl 4.2 | wps 79716 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 50537 | lr 0.000281336 | gnorm 0.305 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 7572 | train_wall 7322
| epoch 081 | valid on 'valid' subset | loss 6.805 | nll_loss 4.568 | ppl 23.72 | num_updates 50537 | best_loss 6.77651
| epoch 082 | loss 4.663 | nll_loss 2.069 | ppl 4.2 | wps 79946 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 51161 | lr 0.000279615 | gnorm 0.312 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 7665 | train_wall 7413
| epoch 082 | valid on 'valid' subset | loss 6.780 | nll_loss 4.537 | ppl 23.21 | num_updates 51161 | best_loss 6.77651
| epoch 083 | loss 4.661 | nll_loss 2.066 | ppl 4.19 | wps 79726 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 51785 | lr 0.000277925 | gnorm 0.310 | clip 1.000 | oom 0.000 | loss_scale 8.000 | wall 7758 | train_wall 7503
| epoch 083 | valid on 'valid' subset | loss 6.766 | nll_loss 4.523 | ppl 22.98 | num_updates 51785 | best_loss 6.76616
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 084 | loss 4.658 | nll_loss 2.062 | ppl 4.18 | wps 79751 | ups 7 | wpb 11862.398 | bsz 904.454 | num_updates 52408 | lr 0.000276268 | gnorm 0.308 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 7852 | train_wall 7594
| epoch 084 | valid on 'valid' subset | loss 6.769 | nll_loss 4.524 | ppl 23 | num_updates 52408 | best_loss 6.7691
| epoch 085 | loss 4.656 | nll_loss 2.059 | ppl 4.17 | wps 79730 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 53032 | lr 0.000274638 | gnorm 0.308 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 7945 | train_wall 7684
| epoch 085 | valid on 'valid' subset | loss 6.786 | nll_loss 4.543 | ppl 23.31 | num_updates 53032 | best_loss 6.77651
| epoch 086 | loss 4.653 | nll_loss 2.056 | ppl 4.16 | wps 79770 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 53656 | lr 0.000273037 | gnorm 0.307 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 8039 | train_wall 7775
| epoch 086 | valid on 'valid' subset | loss 6.751 | nll_loss 4.500 | ppl 22.62 | num_updates 53656 | best_loss 6.75116
| epoch 087 | loss 4.649 | nll_loss 2.051 | ppl 4.14 | wps 79770 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 54280 | lr 0.000271463 | gnorm 0.305 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 8132 | train_wall 7865
| epoch 087 | valid on 'valid' subset | loss 6.756 | nll_loss 4.511 | ppl 22.8 | num_updates 54280 | best_loss 6.7561
| epoch 088 | loss 4.648 | nll_loss 2.049 | ppl 4.14 | wps 79903 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 54904 | lr 0.000269916 | gnorm 0.309 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 8225 | train_wall 7956
| epoch 088 | valid on 'valid' subset | loss 6.768 | nll_loss 4.525 | ppl 23.02 | num_updates 54904 | best_loss 6.76785
| epoch 089 | loss 4.645 | nll_loss 2.046 | ppl 4.13 | wps 79748 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 55528 | lr 0.000268395 | gnorm 0.307 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 8319 | train_wall 8046
| epoch 089 | valid on 'valid' subset | loss 6.785 | nll_loss 4.550 | ppl 23.42 | num_updates 55528 | best_loss 6.77651
| epoch 090 | loss 4.643 | nll_loss 2.043 | ppl 4.12 | wps 79945 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 56152 | lr 0.000266899 | gnorm 0.308 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 8412 | train_wall 8137
| epoch 090 | valid on 'valid' subset | loss 6.742 | nll_loss 4.498 | ppl 22.59 | num_updates 56152 | best_loss 6.74244
| saved checkpoint ./checkpoints/2020-03-12T12-02-04-00/checkpoints_ne_en/checkpoint90.pt (epoch 90 @ 56152 updates) (writing took 0.9954240322113037 seconds)
| epoch 091 | loss 4.642 | nll_loss 2.042 | ppl 4.12 | wps 79732 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 56776 | lr 0.000265429 | gnorm 0.306 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 8506 | train_wall 8227
| epoch 091 | valid on 'valid' subset | loss 6.786 | nll_loss 4.542 | ppl 23.3 | num_updates 56776 | best_loss 6.74244
| epoch 092 | loss 4.639 | nll_loss 2.038 | ppl 4.11 | wps 79979 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 57400 | lr 0.000263982 | gnorm 0.310 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 8600 | train_wall 8318
| epoch 092 | valid on 'valid' subset | loss 6.786 | nll_loss 4.540 | ppl 23.26 | num_updates 57400 | best_loss 6.74244
| epoch 093 | loss 4.637 | nll_loss 2.036 | ppl 4.1 | wps 79576 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 58024 | lr 0.000262559 | gnorm 0.313 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 8693 | train_wall 8408
| epoch 093 | valid on 'valid' subset | loss 6.777 | nll_loss 4.528 | ppl 23.07 | num_updates 58024 | best_loss 6.74244
| epoch 094 | loss 4.634 | nll_loss 2.032 | ppl 4.09 | wps 79727 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 58648 | lr 0.000261158 | gnorm 0.311 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 8787 | train_wall 8498
| epoch 094 | valid on 'valid' subset | loss 6.745 | nll_loss 4.504 | ppl 22.68 | num_updates 58648 | best_loss 6.74244
| epoch 095 | loss 4.632 | nll_loss 2.029 | ppl 4.08 | wps 79880 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 59272 | lr 0.00025978 | gnorm 0.315 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 8880 | train_wall 8589
| epoch 095 | valid on 'valid' subset | loss 6.751 | nll_loss 4.503 | ppl 22.68 | num_updates 59272 | best_loss 6.74244
| epoch 096 | loss 4.628 | nll_loss 2.024 | ppl 4.07 | wps 79708 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 59896 | lr 0.000258423 | gnorm 0.308 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 8973 | train_wall 8679
| epoch 096 | valid on 'valid' subset | loss 6.771 | nll_loss 4.522 | ppl 22.97 | num_updates 59896 | best_loss 6.74244
| epoch 097 | loss 4.627 | nll_loss 2.024 | ppl 4.07 | wps 79780 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 60520 | lr 0.000257087 | gnorm 0.310 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 9067 | train_wall 8770
| epoch 097 | valid on 'valid' subset | loss 6.738 | nll_loss 4.490 | ppl 22.47 | num_updates 60520 | best_loss 6.73823
| epoch 098 | loss 4.624 | nll_loss 2.019 | ppl 4.05 | wps 79771 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 61144 | lr 0.000255772 | gnorm 0.308 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 9160 | train_wall 8860
| epoch 098 | valid on 'valid' subset | loss 6.768 | nll_loss 4.522 | ppl 22.98 | num_updates 61144 | best_loss 6.74244
| epoch 099 | loss 4.624 | nll_loss 2.020 | ppl 4.06 | wps 79863 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 61768 | lr 0.000254477 | gnorm 0.320 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 9254 | train_wall 8951
| epoch 099 | valid on 'valid' subset | loss 6.788 | nll_loss 4.543 | ppl 23.31 | num_updates 61768 | best_loss 6.74244
| epoch 100 | loss 4.621 | nll_loss 2.016 | ppl 4.04 | wps 79657 | ups 7 | wpb 11867.311 | bsz 903.492 | num_updates 62392 | lr 0.000253201 | gnorm 0.312 | clip 1.000 | oom 0.000 | loss_scale 4.000 | wall 9347 | train_wall 9041
| epoch 100 | valid on 'valid' subset | loss 6.746 | nll_loss 4.504 | ppl 22.69 | num_updates 62392 | best_loss 6.74244
| saved checkpoint ./checkpoints/2020-03-12T12-02-04-00/checkpoints_ne_en/checkpoint100.pt (epoch 100 @ 62392 updates) (writing took 0.6386017799377441 seconds)
| done training in 9343.4 seconds
Done training.
Time at end: Thu Mar 12 14:38:35 EDT 2020
